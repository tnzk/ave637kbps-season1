#!/usr/bin/env ruby

$: << ENV['PWD']
require 'hakorb'
require 'sdl'

abort 'Specify a map name like this: ./sim map001.txt' if ARGV.size == 0

SDL.init( SDL::INIT_VIDEO ) 
screen = SDL.setVideoMode( 640, 480, 16, SDL::SWSURFACE ) 
image = SDL::Surface.loadBMP( 'resources/tnzk.bmp' )
image.setColorKey( SDL::SRCCOLORKEY, image.getPixel(0,0) ) 
image = image.displayFormat 

loop do
  while event = SDL::Event2.poll 
    case event 
    when SDL::Event2::Quit 
      exit 
    end
  end

  screen.fillRect( 0, 0, 640, 480, [ 0, 0, 0 ] )
  SDL::Key.scan
  12.times do |y|
    12.times do |x|
      screen.put( image, x * 40, y * 40 )
    end
  end
  screen.updateRect( 0, 0, 0, 0 )

  # image_y -= 1 if SDL::Key.press?( SDL::Key::UP )
  # image_y += 1 if SDL::Key.press?( SDL::Key::DOWN )
end
